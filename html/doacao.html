<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Google fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200;400;700&display=swap" rel="stylesheet">
    <!--Google fonts-->

    <!--Bootstrap icons-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!--Bootstrap icons-->

    <script src="../js/menu.js" defer></script>
    <link rel="stylesheet" href="../css/styledoacao.css">
    <title>doacao</title>
</head>

<body>
    <header>
        <div class="interface">
            <div class="logo">
                <a href="../html/index.html">
                    <img src="../images/Logo-Ceprocom.png-removebg-preview.png" alt="Logo-Ceprocom">
                </a>
            </div> <!--LOGO-->

            <nav class="menu-desktop">
                <ul>
                    <li><a href="../html/index.html">INICIO</a></li>
                    <li><a href="../html/sobre.html">SOBRE</a></li>
                    <li><a href="../html/sobre.html">CONTATO</a></li>
                    <li><a href="../html/doacao.html">COMO AJUDAR</a></li>
                </ul>
            </nav>

            <div class="btn-doacao">
                <a href="../html/doacao.html">
                    <button>DOE AGORA</button>
                </a>
            </div><!--btn-button-->

            <div class="btn-abrir-menu" id="btn-menu">
                <i class="bi bi-list"></i>
            </div>

            <div class="menu-mobile" id="menu-mobile">
                <div class="btn-fechar">
                    <i class="bi bi-x-lg"></i>
                </div><!--btn-fechar-->

                <nav>
                    <ul>
                        <li><a href="../html/index.html">INICIO</a></li>
                        <li><a href="../html/sobre.html">SOBRE</a></li>
                        <li><a href="../html/contact.html">CONTATO</a></li>
                        <li><a href="../html/doacao.html">COMO AJUDAR</a></li>
                        <li><a href="../html/doacao.html">DOE AGORA</a></li>
                    </ul>
                </nav>

            </div><!--menu-mobile-->

            <div class="overlay-menu" id="overlay-menu"></div>


        </div><!--menu-mobile-->
        </div> <!--INTERFACE-->
    </header>

    <main>
        <div class="donation-description-container">
            <section class="donation-header">
                <h2>Juntos, Nós Podemos Ajudar Cada Criança Ter Uma Vida Forte e Segura </h2>

                <p>Neste momento, as crianças precisam do seu apoio compassivo. Por favor, ajude-nos a garantir que as
                    questões críticas às vidas e ao futuro das crianças recebem a máxima prioridade dos nossos líderes
                    eleitos - construindo apoio para garantir que cada criança tenha um início de vida forte.</p>

                <p>Sua doação hoje ajudará a capacitar nossa rede de base de milhares de apoiadorespara pressionar
                    legisladores para avançar:</p>

                <ul class="donation-benefits">
                    <li> Investimentos para combater a fome, educação infantil e cuidados infantis acessíveis nas
                        comunidades rurais para melhorar a qualidade de vida de crianças e famílias desfavorecidas.</li>

                    <li> Visitas domiciliares e educação infantil para crianças desde o nascimento até os 5 anos de
                        idade para ajudar mais crianças a se formarem concluem o ensino secundário, obtêm rendimentos
                        mais elevados e quebram o ciclo da pobreza.</li>

                    <li>Legislação e programas que abordam a fome infantil dos 13 milhões de crianças americanas vivendo
                        na pobreza.</li>

                    <li>Apoio material aos milhões de crianças em todo o mundo que sofrem de fome, doenças,secas,
                        desastres naturais, conflitos armados e outras crises todos os dias.</li>
                </ul>

                <p>Se você acredita que toda criança merece um começo de vida forte, por favor, dê de presente qualquer
                    que seja o seu orçamento permite usar o formulário seguro abaixo:</p>
            </section>
        </div>

        <div class="contact-info">
            <h3>INFORMAÇÕES DE CONTATO</h3>
            <form id="donation-form">
                <div class="form-fields">
                    <div class="input-group">
                        <label for="first-name">Primeiro Nome</label>
                        <input type="text" id="first-name" placeholder="Entre com seu primeiro nome" required>
                    </div>

                    <div class="input-group">
                        <label for="last-name">Último Nome</label>
                        <input type="text" id="last-name" placeholder="Entre com seu último nome" required>
                    </div>

                    <div class="input-group">
                        <label for="postal-code">CEP</label>
                        <input type="text" id="postal-code" placeholder="Entre com seu CEP" required>
                    </div>

                    <div class="input-group">
                        <label for="city">Cidade</label>
                        <input type="text" id="city" placeholder="Enter com sua cidade" readonly>
                    </div>

                    <div class="input-group">
                        <label for="state">Estado</label>
                        <input type="text" id="state" placeholder="Enter com seu estado" readonly>
                    </div>

                    <div class="input-group">
                        <label for="number">Número de Telefone</label>
                        <input type="number" id="number" placeholder="Enter com seu número de celular" required>
                    </div>

                    <div class="input-group">
                        <label for="street-address">Endereço</label>
                        <input type="text" id="street-address" placeholder="Entre com seu endereço" required>
                    </div>

                    <div>
                        <button type="button" class="submitBtn" onclick="sendDonationData()">
                            <span class="btnText">Enviar</span>
                            <i class="bi bi-check-circle"></i>
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <script>
            async function sendDonationData() {
                // Obter todos os valores dos campos
                const firstName = document.getElementById('first-name').value.trim();
                const lastName = document.getElementById('last-name').value.trim();
                const streetAddress = document.getElementById('street-address').value.trim();
                const postalCode = document.getElementById('postal-code').value.trim();
                const city = document.getElementById('city').value.trim();
                const state = document.getElementById('state').value.trim();
                const number = document.getElementById('number').value.trim();

                // Verificar se todos os campos estão preenchidos
                if (!firstName || !lastName || !streetAddress || !postalCode || !city || !state || !number) {
                    alert('Por favor, preencha todos os campos obrigatórios.');
                    return; // Não enviar os dados
                }

                // Dados para serem enviados
                const data = {
                    firstName,
                    lastName,
                    streetAddress,
                    postalCode,
                    city,
                    state,
                    number
                };

                try {
                    // Enviar os dados via POST para o servidor
                    const response = await fetch('http://localhost:3000/add-doador', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        alert('Doador adicionado com sucesso: ' + result.message);
                    } else {
                        alert('Erro ao adicionar doador');
                    }
                } catch (error) {
                    console.error('Erro:', error);
                    alert('Erro ao conectar ao servidor');
                }
            }
        </script>
        <div class="contribution-info">
            <h3>INFORMAÇÕES DE CONTRIBUIÇÃO</h3>

            <div class="contribution-type">
                <input type="radio" id="one-time" name="contribution-type" value="one-time">
                <label for="one-time">Única Doação</label>

                <input type="radio" id="monthly" name="contribution-type" value="monthly" checked>
                <label for="monthly">Doação Mensal</label>
            </div>

            <div class="amount-options" id="amount-options">
                <!-- Botões de valores iniciais -->
            </div>

            <div class="custom-amount-container">
                <div class="custom-amount-wrapper">
                    <span class="currency-symbol">R$</span>
                    <input type="number" id="custom-amount" placeholder="0.00" class="custom-amount">
                </div>
            </div>

            <div class="transaction-container">
                <div class="transaction-fee-option">
                    <label>
                        <input type="checkbox" id="cover-fee"> Gostaria de ajudar a cobrir as taxas de transação da
                        minha doação.
                    </label>
                </div>

                <button id="generate-qr">Gerar QR Code PIX</button>
            </div>

            <!-- Campo de entrada para o email do doador -->
            <div class="email-container">
                <label for="email">Email:</label>
                <input type="email" id="email" placeholder="Digite seu email" required>
            </div>

            <!-- Estrutura do modal para exibir o QR Code -->
            <div id="qrModal" class="modal">
                <div class="modal-content">
                    <span class="close">&times;</span>
                    <h2>Escaneie o QR Code abaixo para concluir a doação</h2>
                    <div id="qrCodeContainer"></div> <!-- QR code será inserido aqui -->
                </div>
            </div>

            <!-- Certifique-se de que o JavaScript está sendo carregado corretamente no seu HTML -->
            <script>
                document.getElementById('generate-qr').addEventListener('click', async function () {
                    const selectedAmount = parseFloat(document.getElementById('custom-amount').value);  // Captura o valor da doação
                    const email = document.getElementById('email').value;  // Captura o email do usuário
                    const description = 'Doação via PIX';  // Descrição da doação

                    if (!selectedAmount || selectedAmount <= 0) {
                        alert('Por favor, insira um valor válido.');
                        return;
                    }

                    if (!email) {
                        alert('Por favor, insira um email válido.');
                        return;
                    }

                    try {
                        const response = await fetch('http://localhost:3000/create-payment', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                transaction_amount: selectedAmount,
                                description: description,
                                email: email
                            })
                        });

                        const result = await response.json();
                        console.log(result);  // Verifica a resposta completa do backend

                        if (result.success && result.payment) {
                            // Exibir o QR Code gerado
                            const qrCodeContainer = document.getElementById('qrCodeContainer');
                            qrCodeContainer.innerHTML = `<img src="data:image/png;base64,${result.payment.point_of_interaction.transaction_data.qr_code_base64}" alt="QR Code PIX">`;

                            // Exibir o modal com o QR Code
                            const modal = document.getElementById('qrModal');
                            modal.style.display = 'block';
                        } else {
                            alert('Erro ao gerar o pagamento.');
                        }
                    } catch (error) {
                        console.error('Erro ao processar o pagamento:', error);
                        alert('Erro ao processar o pagamento.');
                    }
                });

            </script>
        </div>
    </main>

    <footer>
        <div class="interface">
            <section class="line-footer1">

                <h2>Quer receber noticias sobre nossos eventos ? </h2>
                <p>Insira seu e-mail e fique por dentro de todos os eventos do ano do ceprocom.</p>
                <form id="newsletter-form">
                    <input type="email" id="newsletter-email" placeholder="Digite seu e-mail" required>
                    <input type="button" value="CADASTRE-SE" class="btn-cadastre-se" onclick="sendNewsletterEmail()">
                </form>

            </section>

            <section class="line-footer2">

                <div class="box-line-footer">
                    <img src="../images/Logo-Ceprocom.png-removebg-preview.png" alt="logotipo Ceprocom">
                    <p>"EDUCANDO PARA A VIDA E A ESPERANCA"</p>
                </div>

                <div class="box-line-footer">

                    <h3>HOME</h3>
                    <div class="links-footers">
                        <a href="../html/index.html">Inicio</a>
                        <a href="#">Sobre</a>
                        <a href="#">Contato</a>
                        <a href="../html/doacao.html">Como Ajudar</a>
                    </div>
                </div>

                <div class="box-line-footer">
                    <h3>NOSSO ENDERECO</h3>
                    <div class="endereco-footers">
                        <ul>
                            <li>São Bento do Sapucaí, SP</li>
                            <li>Centro</li>
                            <li>Avenida Aparecida, 81</li>
                            <li>12490-000</li>
                            <li>(12) 99684-8263</li>
                        </ul>
                    </div>
                </div>

                <div class="box-line-footer">
                    <h3>SUPORTE</h3>
                    <div class="links-footers">
                        <a href="#">Politica de privacidade</a>
                        <a href="mailto:seuemail@exemplo.com?subject=Contato&body=Escreva%20sua%20mensagem%20aqui">Enviar
                            um email</a>
                        <a href="#">FAQ</a>
                    </div>
                </div>


                <div class="box-line-footer">
                    <h3>NOS SIGA</h3>
                    <div class="btn-redes">
                        <a href="https://www.facebook.com/centropromocionalcomunitario.ceprocom"
                            target="_blank"><button><i class="bi bi-facebook"></i></button></a>
                        <a href="https://wa.me/5511999999999?text=Olá%2C%20gostaria%20de%20saber%20mais%20informações!"
                            target="_blank"><button><i class="bi bi-whatsapp"></i></button></a>
                        <a href="https://www.instagram.com/ceprocom/" target="_blank"><button><i
                                    class="bi bi-instagram"></i></button></a>
                    </div>
                </div>

            </section>

            <section class="line-footer3">
                <p>Ceprocom 2024 &copy; Todos os direitos reservados</p>
            </section>
        </div>
    </footer>

    <script>
        async function sendNewsletterEmail() {
            const email = document.getElementById('newsletter-email').value;

            if (!email) {
                alert('Por favor, insira um e-mail válido.');
                return;
            }

            try {
                const response = await fetch('http://localhost:3000/add-inscrito', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email }),
                });

                if (response.ok) {
                    const result = await response.json();
                    alert(result.message); // Mensagem de sucesso
                } else {
                    const errorResult = await response.json();
                    alert(errorResult.error); // Mensagem de erro
                }
            } catch (error) {
                console.error('Erro ao enviar o e-mail:', error);
                alert('Erro ao conectar ao servidor.');
            }
        }
    </script>
    <script src="../cep.js"></script>
    <script src="../js/doacao.js"></script>
    <script src="../requerimento.js"></script>
</body>

</html>